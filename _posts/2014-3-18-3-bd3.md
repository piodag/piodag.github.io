---
layout: post
title: "Bayesian Deming regression - About the sampling method"
use_math: true
---

The basic concept in rstanbdp is to sample a single error term instead of two. The
idea comes from the Weighted Deming procedure proposed by Linnet in multiple
articles, for example [K. Linnet, Clinical Chemistry 44:5, 1024-1031 (1998)](https://doi.org/10.1093/clinchem/44.5.1024)

Given a set of $$N$$ pairs of $$ X $$ and $$ Y $$ in $$ \mathbb{R^{2}} $$ and for a fixed error ratio $$ \lambda = \frac{\sigma^{2}_{X}}{\sigma^{2}_{Y}} $$ the estimated $$ \hat{X} $$ and $$ \hat{Y}$$ are calculated as follow, given $$ \alpha$$ the intercept and $$ beta $$ the slope that are sampled from the priors (see further below for priors).

$$ P_{i} = X_{i} \cdot \beta + \alpha  $$

$$  \delta_{i} = Y_{i} - P_{i}  $$

$$  \hat{X}_{i} = X_{i} + \frac{\lambda \cdot \delta_{i} \cdot \beta}{1 + \lambda \cdot \beta^2} $$

$$  \hat{Y}_{i} = Y_{i} - \frac{\delta_{i}}{1 + \lambda \cdot \beta^2} $$


Then the euclidian distances $$ e $$ of the estimated points from its real position are calculated with:


$$  e_{i} = sqrt{(X_{i} - \hat{X}^{2}_{i}) + (Y - \hat{Y})^{2}_{i})}  $$


Thus in the Bayesian model, setting the following priors

$$ \alpha \sim \mathcal{N}(\hat{\alpha}, \sigma^{2}_{\alpha}) $$

$$ \beta \sim \mathcal{N}(\hat{\beta}, \sigma^{2}_{\beta) $$

$$ \sigma \sim \mathcal{E}(\lambda_{sigma}) $$



The likelihood gets optimised as

$$ e_{i} \sim \mathcal{T}(0,\sigma,df = N-2)  $$

Of course a normal distribution for the likelihood would also be a good option. Test




